<!DOCTYPE html ><html><head><META http-equiv="Content-Type" content="text/html; charset=utf-8"><meta charset="utf-8"><link rel="shortcut icon" href="../icons/favicon.ico"><link rel="stylesheet" type="text/css" href="../styles/branding.css"><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css"><script type="text/javascript" src="../scripts/branding.js"> </script><title>Shell Service Extensions</title><meta name="Language" content="en-us"><meta name="Microsoft.Help.Id" content="c2cfc56d-e966-492a-9b12-66c7d01e7146"><meta name="Description" content="Shell Services utility library for Visual Studio extension developers."><meta name="Microsoft.Help.ContentType" content="Concepts"><meta name="BrandingAware" content="true"><link type="text/css" rel="stylesheet" href="../styles/highlight.css"><script type="text/javascript" src="../scripts/highlight.js"> </script><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css"><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle"><div class="pageHeader" id="PageHeader">Tunnel Vision Labs' Base Extensions Library for Visual Studio<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!"></a><a data-tochassubtree="true" href="262e0a6e-ce5a-4f40-8f5e-3889dbb63784.htm" title="Tunnel Vision Labs' Base Extensions Library for Visual Studio" tocid="roottoc">Tunnel Vision Labs' Base Extensions Library for Visual Studio</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!"></a><a data-tochassubtree="true" href="69c59220-5eff-4177-a632-b7c1b4981501.htm" title="Packages" tocid="69c59220-5eff-4177-a632-b7c1b4981501">Packages</a></div><div class="toclevel1 current" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!"></a><a data-tochassubtree="true" href="c2cfc56d-e966-492a-9b12-66c7d01e7146.htm" title="Shell Service Extensions" tocid="c2cfc56d-e966-492a-9b12-66c7d01e7146">Shell Service Extensions</a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!"></a><a data-tochassubtree="true" href="ef23c357-11af-4eed-a698-0c5a84b8c8cc.htm" title="Version History" tocid="ef23c357-11af-4eed-a698-0c5a84b8c8cc">Version History</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize"><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize"></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img src="../icons/Help.png"></td><td class="titleColumn">Shell Service Extensions</td></tr></table><span class="introStyle"></span><div class="summary"><p>Shell Services utility library for Visual Studio extension developers.</p></div><div class="introduction"><p>
        The Shell Services package provides extension methods to simplify access to services provided by
        service providers, as well as access to global services provided by the Visual Studio IDE.
      </p><p>
        Library Status: Public
      </p></div><div class="collapsibleAreaRegion" id="Installation"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png">Installation and Distribution</span></div><div id="ID1RBSection" class="collapsibleSection"><p>
          This package may be installed through NuGet. Separate packages are available depending on the
          specific version of Visual Studio an extension is targeting.
        </p><ul><li><p><span class="code">Tvl.VisualStudio.ShellServices.10</span>: For extensions targeting Visual Studio 2010 and newer.
            </p></li><li><p><span class="code">Tvl.VisualStudio.ShellServices.11</span>: For extensions targeting Visual Studio 2012 and newer.
            </p></li><li><p><span class="code">Tvl.VisualStudio.ShellServices.12</span>: For extensions targeting Visual Studio 2013 and newer.
            </p></li></ul><p>
          This is a Utility Library package, as described on the <a href="69c59220-5eff-4177-a632-b7c1b4981501.htm">Packages</a> page. If you are
          registering this assembly using the <a href="http://msdn2.microsoft.com/en-us/library/hh255336" target="_blank">ProvideCodeBaseAttribute</a>
          attribute, use the following code to replace the described placeholders.
        </p><ul><li><p>
              For extensions targeting Visual Studio 2012 and newer.
            </p><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EAABAADAAA_tab1" class="codeSnippetContainerTabSingle">C#</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EAABAADAAA_copyCode" href="#" onclick="javascript:CopyToClipboard('ID0EAABAADAAA');return false;" title="Copy">Copy</a></div></div><div id="ID0EAABAADAAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve">[assembly: ProvideCodeBase(
    AssemblyName = <span class="highlight-literal">"Tvl.VisualStudio.ShellServices.11"</span>,
    Version = <span class="highlight-literal">"1.0.0.0"</span>,
    CodeBase = <span class="highlight-literal">"$PackageFolder$\\Tvl.VisualStudio.ShellServices.11.dll"</span>)]</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EAABAADAAA");</script></li><li><p>
              For extensions targeting Visual Studio 2013 and newer.
            </p><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EAAAAADAAA_tab1" class="codeSnippetContainerTabSingle">C#</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EAAAAADAAA_copyCode" href="#" onclick="javascript:CopyToClipboard('ID0EAAAAADAAA');return false;" title="Copy">Copy</a></div></div><div id="ID0EAAAAADAAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve">[assembly: ProvideCodeBase(
    AssemblyName = <span class="highlight-literal">"Tvl.VisualStudio.ShellServices.12"</span>,
    Version = <span class="highlight-literal">"1.0.0.0"</span>,
    CodeBase = <span class="highlight-literal">"$PackageFolder$\\Tvl.VisualStudio.ShellServices.12.dll"</span>)]</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EAAAAADAAA");</script></li></ul></div><div class="collapsibleAreaRegion" id="Use"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png">Using the Extension Methods</span></div><div id="ID2RBSection" class="collapsibleSection"><p>
          Extension methods for the following types are included.
        </p><ul><li><p><a href="http://msdn2.microsoft.com/en-us/library/zbywf1tw" target="_blank">System<span id="LST6675C62D_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST6675C62D_0?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>IServiceProvider</a></p></li><li><p><a href="http://msdn2.microsoft.com/en-us/library/ms363650" target="_blank">Microsoft.VisualStudio.OLE.Interop<span id="LST6675C62D_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST6675C62D_1?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>IServiceProvider</a></p></li><li><p><a href="http://msdn2.microsoft.com/en-us/library/ee848656" target="_blank">Microsoft.VisualStudio.Shell<span id="LST6675C62D_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST6675C62D_2?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>SVsServiceProvider</a></p></li></ul><h4 class="subHeading">Accessing MEF Services from a Package</h4><div class="subsection"><p>
              Accessing MEF services from a package requires using the
              <a href="http://msdn2.microsoft.com/en-us/library/ee830950" target="_blank">IComponentModel</a>
              global service. For example, within an implementation of
              <a href="http://msdn2.microsoft.com/en-us/library/bb138363" target="_blank">Initialize<span id="LST6675C62D_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST6675C62D_3?cs=()|vb=|cpp=()|nu=()|fs=()");</script></a>, the
              following code could be used to obtain an instance of the
              <a href="http://msdn2.microsoft.com/en-us/library/dd885816" target="_blank">IVsEditorAdaptersFactoryService</a>
              service, which is only provided as an MEF-exported component.
            </p><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EAAABACAAA_tab1" class="codeSnippetContainerTabSingle">C#</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EAAABACAAA_copyCode" href="#" onclick="javascript:CopyToClipboard('ID0EAAABACAAA');return false;" title="Copy">Copy</a></div></div><div id="ID0EAAABACAAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve">Package package = <span class="highlight-keyword">this</span>;
<span class="highlight-keyword">var</span> componentModel = package.AsVsServiceProvider().GetComponentModel();
<span class="highlight-keyword">var</span> exportProvider = componentModel.DefaultExportProvider;
<span class="highlight-keyword">var</span> service = exportProvider.GetExport&lt;IVsEditorAdaptersFactoryService&gt;();</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EAAABACAAA");</script></div><h4 class="subHeading">Accessing Global Services from an MEF Component</h4><div class="subsection"><p>
              Accessing global services from an MEF component is straightforward. Simply import an instance of
              <a href="http://msdn2.microsoft.com/en-us/library/ee848656" target="_blank">SVsServiceProvider</a> and use the
              appropriate extension methods to get an instance of the desired global service interface.
            </p></div></div><div class="collapsibleAreaRegion" id="Implementation"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png">Implementation Details</span></div><div id="ID3RBSection" class="collapsibleSection"><p>
          This package simplifies access to these global services by ensuring the correct access method is used.
          For example, consider the differences required for accessing each of the following services.
        </p><ul><li><p><a href="http://msdn2.microsoft.com/en-us/library/bb167160" target="_blank">IVsAddProjectItemDlg</a>: This global
              service is accessed by simply requesting an instance of <a href="http://msdn2.microsoft.com/en-us/library/bb170235" target="_blank">SVsAddProjectItemDlg</a>
              from the service provider. This naming pattern is common in the Visual Studio SDK, but not all-inclusive.
            </p></li><li><p><a href="http://msdn2.microsoft.com/en-us/library/ms363650" target="_blank">IServiceProvider</a>: This global
              service is accessed by simply requesting an instance of the interface from the service provider.
            </p></li><li><p><a href="http://msdn2.microsoft.com/en-us/library/bb168506" target="_blank">IVsNavigationTool</a>: This global
              service is accessed by requesting an instance of <a href="http://msdn2.microsoft.com/en-us/library/bb170245" target="_blank">SVsClassView</a>
              from the service provider. This interface is the best representation of the <strong>Class View</strong> pane,
              despite the fact that <a href="http://msdn2.microsoft.com/en-us/library/bb167258" target="_blank">IVsClassView</a> is
              another available interface.
            </p></li><li><p><a href="http://msdn2.microsoft.com/en-us/library/bb167859" target="_blank">IVsFontAndColorUtilities</a>: This global
              service is accessed by requesting an instance of <a href="http://msdn2.microsoft.com/en-us/library/bb170320" target="_blank">SVsFontAndColorStorage</a>,
              and is one of two global service interfaces provided by this object (the other is <a href="http://msdn2.microsoft.com/en-us/library/bb167853" target="_blank">IVsFontAndColorStorage</a>).
            </p></li><li><p><a href="http://msdn2.microsoft.com/en-us/library/h1y54b59" target="_blank">IVsExpansionManager</a>: This global
              service is accessed by first obtaining the <a href="http://msdn2.microsoft.com/en-us/library/sz7900h5" target="_blank">IVsTextManager2</a>
              service, and calling the <a href="http://msdn2.microsoft.com/en-us/library/xf0bc9ae" target="_blank">GetExpansionManager(IVsExpansionManager<span id="LST6675C62D_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST6675C62D_4?cpp=%");</script>)</a>
              method on the result.
            </p></li><li><p><a href="http://msdn2.microsoft.com/en-us/library/sz7900h5" target="_blank">IVsTextManager2</a>: This global
              service is accessed by simply requesting an instance of <a href="http://msdn2.microsoft.com/en-us/library/exwt6xt1" target="_blank">VsTextManagerClass</a>
              from the service provider. The pattern is similar to <a href="http://msdn2.microsoft.com/en-us/library/bb167160" target="_blank">IVsAddProjectItemDlg</a>
              above, but the naming convention is different.
            </p></li><li><p><a href="http://msdn2.microsoft.com/en-us/library/dd885429" target="_blank">IGlyphService</a>: This global
              service is accessed by first obtaining an instance of <a href="http://msdn2.microsoft.com/en-us/library/ee830950" target="_blank">IComponentModel</a>
              from the service provider, and then calling the <a href="http://msdn2.microsoft.com/en-us/library/ee830930" target="_blank">GetService<span id="LST6675C62D_5"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST6675C62D_5?cs=<|vb=(Of |cpp=<|fs=<'|nu=(");</script>T<span id="LST6675C62D_6"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST6675C62D_6?cs=>|vb=)|cpp=>|fs=>|nu=)");</script><span id="LST6675C62D_7"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST6675C62D_7?cs=()|vb=|cpp=()|nu=()|fs=()");</script></a>
              method. This pattern is common for global services that are provided through the Managed Extensibility Framework (MEF) rather than
              through the traditional Visual Studio service mechanisms.
            </p></li></ul></div></div></div><div id="pageFooter" class="pageFooter"></div></body></html>